<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"qixinbo.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="ä»‹ç» pytorch-acceleratedæ˜¯ä¸€ä¸ªè½»é‡çº§çš„åº“ï¼Œæ—¨åœ¨é€šè¿‡æä¾›ä¸€ä¸ªæœ€å°ä½†å¯æ‰©å±•çš„è®­ç»ƒå¾ªç¯ï¼ˆå°è£…åœ¨ä¸€ä¸ªTrainerå¯¹è±¡ä¸­ï¼‰æ¥åŠ é€ŸPyTorchæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼›å®ƒè¶³å¤Ÿçµæ´»ï¼Œå¯ä»¥å¤„ç†å¤§å¤šæ•°ç”¨ä¾‹ï¼Œå¹¶ä¸”èƒ½å¤Ÿåˆ©ç”¨ä¸åŒçš„ç¡¬ä»¶é€‰é¡¹è€Œä¸éœ€è¦ä¿®æ”¹ä»£ç ã€‚æ›´å¤šä»‹ç»è§åŸä½œè€…çš„åšæ–‡ã€‚ pytorch-acceleratedæœ€å¤§çš„ä¸¤ä¸ªç‰¹ç‚¹å°±æ˜¯ï¼šç®€å•simplicityå’Œé€æ˜transparencyã€‚æ€ä¹ˆç†è§£è¿™ä¸¤ä¸ª">
<meta property="og:type" content="article">
<meta property="og:title" content="è½»é‡çº§PyTorché€šç”¨è®­ç»ƒæ¨¡æ¿pytorch-acceleratedè§£æï¼š0 -- ä»‹ç»åŠå…¥é—¨">
<meta property="og:url" content="http://qixinbo.github.io/2022/05/28/pytorch-accelerated_0/index.html">
<meta property="og:site_name" content="æ•°å­—æ——æ‰‹">
<meta property="og:description" content="ä»‹ç» pytorch-acceleratedæ˜¯ä¸€ä¸ªè½»é‡çº§çš„åº“ï¼Œæ—¨åœ¨é€šè¿‡æä¾›ä¸€ä¸ªæœ€å°ä½†å¯æ‰©å±•çš„è®­ç»ƒå¾ªç¯ï¼ˆå°è£…åœ¨ä¸€ä¸ªTrainerå¯¹è±¡ä¸­ï¼‰æ¥åŠ é€ŸPyTorchæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼›å®ƒè¶³å¤Ÿçµæ´»ï¼Œå¯ä»¥å¤„ç†å¤§å¤šæ•°ç”¨ä¾‹ï¼Œå¹¶ä¸”èƒ½å¤Ÿåˆ©ç”¨ä¸åŒçš„ç¡¬ä»¶é€‰é¡¹è€Œä¸éœ€è¦ä¿®æ”¹ä»£ç ã€‚æ›´å¤šä»‹ç»è§åŸä½œè€…çš„åšæ–‡ã€‚ pytorch-acceleratedæœ€å¤§çš„ä¸¤ä¸ªç‰¹ç‚¹å°±æ˜¯ï¼šç®€å•simplicityå’Œé€æ˜transparencyã€‚æ€ä¹ˆç†è§£è¿™ä¸¤ä¸ª">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-05-27T16:00:00.000Z">
<meta property="article:modified_time" content="2022-06-22T15:17:40.536Z">
<meta property="article:author" content="Xin-Bo Qi(äº“æ¬£æ³¢)">
<meta property="article:tag" content="PyTorch">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://qixinbo.github.io/2022/05/28/pytorch-accelerated_0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>è½»é‡çº§PyTorché€šç”¨è®­ç»ƒæ¨¡æ¿pytorch-acceleratedè§£æï¼š0 -- ä»‹ç»åŠå…¥é—¨ | æ•°å­—æ——æ‰‹</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="æ•°å­—æ——æ‰‹" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">æ•°å­—æ——æ‰‹</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">ç”µæ°”åŒ–ã€è‡ªåŠ¨åŒ–ã€æ•°å­—åŒ–ã€æ™ºèƒ½åŒ–ã€æ™ºæ…§åŒ–</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-scholar">

    <a href="/scholar/" rel="section"><i class="fa fa-chart-bar fa-fw"></i>scholar</a>

  </li>
        <li class="menu-item menu-item-sources">

    <a href="/sources/" rel="section"><i class="fa fa-rss fa-fw"></i>sources</a>

  </li>
        <li class="menu-item menu-item-gallery">

    <a href="/gallery/" rel="section"><i class="fa fa-file-image fa-fw"></i>gallery</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404.html" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://qixinbo.github.io/2022/05/28/pytorch-accelerated_0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Xin-Bo Qi(äº“æ¬£æ³¢)">
      <meta itemprop="description" content="Digitize everything to realize Digitalization!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ•°å­—æ——æ‰‹">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          è½»é‡çº§PyTorché€šç”¨è®­ç»ƒæ¨¡æ¿pytorch-acceleratedè§£æï¼š0 -- ä»‹ç»åŠå…¥é—¨
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-28 00:00:00" itemprop="dateCreated datePublished" datetime="2022-05-28T00:00:00+08:00">2022-05-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-06-22 23:17:40" itemprop="dateModified" datetime="2022-06-22T23:17:40+08:00">2022-06-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine learning</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2022/05/28/pytorch-accelerated_0/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022/05/28/pytorch-accelerated_0/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p><a target="_blank" rel="noopener" href="https://github.com/Chris-hughes10/pytorch-accelerated"><code>pytorch-accelerated</code></a>æ˜¯ä¸€ä¸ªè½»é‡çº§çš„åº“ï¼Œæ—¨åœ¨é€šè¿‡æä¾›ä¸€ä¸ªæœ€å°ä½†å¯æ‰©å±•çš„è®­ç»ƒå¾ªç¯ï¼ˆå°è£…åœ¨ä¸€ä¸ª<code>Trainer</code>å¯¹è±¡ä¸­ï¼‰æ¥åŠ é€Ÿ<code>PyTorch</code>æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼›å®ƒè¶³å¤Ÿçµæ´»ï¼Œå¯ä»¥å¤„ç†å¤§å¤šæ•°ç”¨ä¾‹ï¼Œå¹¶ä¸”èƒ½å¤Ÿåˆ©ç”¨ä¸åŒçš„ç¡¬ä»¶é€‰é¡¹è€Œä¸éœ€è¦ä¿®æ”¹ä»£ç ã€‚æ›´å¤šä»‹ç»è§åŸä½œè€…çš„<a target="_blank" rel="noopener" href="https://towardsdatascience.com/introducing-pytorch-accelerated-6ba99530608c">åšæ–‡</a>ã€‚<br><code>pytorch-accelerated</code>æœ€å¤§çš„ä¸¤ä¸ªç‰¹ç‚¹å°±æ˜¯ï¼šç®€å•<code>simplicity</code>å’Œé€æ˜<code>transparency</code>ã€‚æ€ä¹ˆç†è§£è¿™ä¸¤ä¸ªè¯å‘¢ï¼ˆä¸ªäººç†è§£ï¼‰ï¼š<br>ï¼ˆ1ï¼‰ç®€å•ä½“ç°åœ¨å®ƒæ˜¯ä¸€å¥—å¯å¤ç”¨çš„<code>PyTorch</code>çš„è®­ç»ƒä»£ç ï¼Œæ¯æ¬¡æœ‰æ–°æ¨¡å‹å’Œæ–°åœºæ™¯éœ€è¦è®­ç»ƒæ—¶ä¸å¿…å°†åŸæ¥çš„ä»£ç æ‹·è¿‡æ¥æ‹·è¿‡å»ï¼Œ<code>pytorch-accelerated</code>æä¾›äº†ä¸€å¥—é€šç”¨ä½†ä¸å¤±çµæ´»æ€§çš„ä»£ç æ¨¡æ¿ï¼›<br>ï¼ˆ2ï¼‰é€æ˜ä½“ç°åœ¨å®ƒåŸºäºçº¯æ­£çš„<code>PyTorch</code>è¯­æ³•å’Œ<code>API</code>ï¼Œè€Œä¸æ˜¯å¯¹<code>PyTorch</code>è¿›è¡Œè¿‡åº¦å°è£…ï¼ˆæ­¤å¤„<code>PyTorch Lightning</code>ä¸­æªï¼‰ï¼Œå¦åˆ™ç”¨æˆ·ä¼šæ„Ÿè§‰æ–°å­¦ä¹ äº†ä¸€å¥—æ¡†æ¶å’Œè¯­æ³•ã€‚<br>è¿™é‡Œå¯ä»¥å†æ‰©å±•è¯´ä¸€ä¸‹ï¼Œä½œè€…çš„<a target="_blank" rel="noopener" href="https://towardsdatascience.com/introducing-pytorch-accelerated-6ba99530608c">ä»‹ç»åšæ–‡</a>åæœ‰ä¸€æ¡è¯„è®ºï¼šâ€œè¿™ä¸ªåº“ä¸<code>PyTorch Lighting</code>å¯¹æ¯”æ€ä¹ˆæ ·ï¼Œæˆ‘å·²ç»ç”¨äº†<code>Lightning</code>ï¼Œä¸ºå•¥è¦ç”¨è¿™ä¸ªåº“å‘¢ï¼Ÿâ€ä½œè€…ç»™å‡ºäº†ä¸€ä¸ªé•¿é•¿çš„å›ç­”ï¼Œè§£é‡Šå¾—æŒºæ¸…æ™°çš„ï¼š</p>
<blockquote>
<p>æˆ‘ä½¿ç”¨<code>Lightning</code>å¾ˆé•¿æ—¶é—´äº†ï¼Œä½†è¶Šæ¥è¶Šè§‰å¾—æˆ‘èŠ±åœ¨ç†è§£å’Œè°ƒè¯•<code>Lightning</code>ä¸Šçš„æ—¶é—´æ¯”èŠ±åœ¨ä»»åŠ¡ä¸Šçš„æ—¶é—´å¤šã€‚è¿™åœ¨ä¸€å¼€å§‹å¯èƒ½å¾ˆç®€å•ï¼Œä½†ç”±äºé€‰é¡¹å’ŒæŒ‡æ ‡å¤ªå¤šï¼Œæˆ‘å‘ç°è‡ªå·±èŠ±äº†å¾ˆå¤šæ—¶é—´é˜…è¯»æ–‡æ¡£ï¼Œå¹¶å‘ç°æºä»£ç å¯¹æˆ‘æ¥è¯´å¹¶ä¸å®¹æ˜“ä¸€ç›®äº†ç„¶ã€‚<br>å¦å¤–ï¼Œä»ä¸€å¼€å§‹æˆ‘å°±å‘ç°ï¼Œ<code>Lightning</code>çš„è®¾è®¡ï¼Œå³æ¨¡å‹å’Œè®­ç»ƒå¾ªç¯ç»‘åœ¨ä¸€èµ·ï¼Œå¹¶ä¸é€‚åˆæˆ‘æƒ³ä¸ºåŒä¸€ä¸ªä»»åŠ¡è½»æ¾åˆ‡æ¢ä¸åŒçš„æ¨¡å‹å’Œä¼˜åŒ–å™¨çš„åœºæ™¯ï¼›æˆ‘ä¸ªäººæ›´å–œæ¬¢è®­ç»ƒå¾ªç¯ä¸æ¨¡å‹åˆ†å¼€ã€‚è¿™æ„å‘³ç€æ¨¡å‹ä»ç„¶æ˜¯çº¯æ­£çš„<code>PyTorch</code>ï¼›æˆ‘å¯ä»¥æ’å…¥å…¶ä»–åº“çš„æ¨¡å‹ï¼Œå¦‚<code>timm</code>ï¼Œè€Œä¸éœ€è¦åšä»»ä½•ä¿®æ”¹ï¼Œä¹Ÿä¸éœ€è¦åœ¨éƒ¨ç½²æ—¶æœ‰ä»»ä½•é¢å¤–çš„ä¾èµ–ã€‚<br>ä»æœ¬è´¨ä¸Šè®²ï¼Œæˆ‘æƒ³è¦ä¸€ä¸ªç®€å•æ˜“æ‡‚ã€æ˜“äºè°ƒè¯•çš„åº“ï¼ŒåŒæ—¶ä¿æŒè¶³å¤Ÿçš„çµæ´»æ€§ä»¥æ»¡è¶³æˆ‘çš„éœ€è¦ï¼›å­¦ä¹ æ›²çº¿è¶³å¤Ÿæµ…ï¼Œæˆ‘å¯ä»¥æŠŠå®ƒä»‹ç»ç»™å…¶ä»–äººï¼Œä»–ä»¬ä¹Ÿå¯ä»¥å¾ˆå¿«ä¸Šæ‰‹ã€‚æ ¹æ®æˆ‘è‡ªå·±çš„è¦æ±‚ï¼Œæˆ‘åˆ›å»ºäº†PyTorch-acceleratedã€‚å®ƒåœ¨ç®€å•çš„æƒ…å†µä¸‹å¼€ç®±å³ç”¨ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å®šåˆ¶è¡Œä¸ºçš„ä»»ä½•éƒ¨åˆ†ã€‚</p>
</blockquote>
<p>å†å†æ‰©å±•è¯´ä¸€ä¸‹ï¼Œå¯¹äº<code>PyTorch Lightning</code>ï¼ŒçŸ¥ä¹ä¸Šæœ‰å¾ˆå¤šçœŸé¦™å¸–ï¼ˆæ¯”å¦‚<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/353985363">1</a>ã€<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/157742258">2</a>ï¼‰ï¼Œä¹Ÿæœ‰å¾ˆå¤šåŠé€€å¸–ï¼ˆæ¯”å¦‚<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/492703063">1</a>ã€<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/363045412">2</a>ï¼ˆè¿™ç¯‡è™½ç„¶ä»æ ‡é¢˜å’Œå…¨æ–‡ä¸Šçœ‹æ˜¯â€œçœŸé¦™â€ï¼Œå®åˆ™åœ¨æ–‡ç« æœ€åå’Œè¯„è®ºä¸­ä½œè€…è¡¨ç¤ºå¼ƒå‘äº†ï¼Œé‡‡ç”¨äº†åŸç”Ÿçš„<code>PyTorch</code>ï¼‰ï¼‰ã€‚ä¸ªäººæ„Ÿè§‰é‡‡ç”¨<code>PyTorch Lightning</code>æœ‰ä¸¤ä¸ªå¾ˆå¤§çš„å¼Šç«¯ï¼ˆä¸¥æ ¼æ¥è¯´å…¶å®æ˜¯ä¸€ä¸ªï¼‰ï¼š<br>ï¼ˆ1ï¼‰ä¸åŸç”Ÿ<code>PyTorch</code>ç›¸æ¯”ï¼Œ<code>PyTorch Lightning</code>è¿›è¡Œäº†è¿‡åº¦å°è£…ï¼Œæ„Ÿè§‰åƒæ˜¯åœ¨å­¦ä¹ å¦ä¸€ä¸ªæ¡†æ¶ï¼›<br>ï¼ˆ2ï¼‰å‡è®¾ä½¿ç”¨<code>PyTorch Lightning</code>ç¼–å†™ä»£ç ï¼Œå¦‚æœæ˜¯ä¸ªäººä½¿ç”¨è¿˜å¥½ï¼Œä½†å¦‚æœæ˜¯ä¸€ä¸ªå›¢é˜Ÿå…±åŒç»´æŠ¤ä»£ç ï¼Œå¾ˆéš¾è¯´æœåˆ«äººä¹Ÿé‡‡ç”¨è¯¥å†™æ³•ã€‚<br>äºæ˜¯ï¼Œæœ¬æ–‡çš„ä¸»è§’<code>pytorch-accelerated</code>å°±æœ‰äº†ç”¨æ­¦ä¹‹åœ°ã€‚</p>
<h2 id="ç›®æ ‡ç”¨æˆ·"><a href="#ç›®æ ‡ç”¨æˆ·" class="headerlink" title="ç›®æ ‡ç”¨æˆ·"></a>ç›®æ ‡ç”¨æˆ·</h2><p>ä»€ä¹ˆç±»å‹çš„ç”¨æˆ·/å¼€å‘è€…å¯ä»¥å°è¯•ä½¿ç”¨<code>pytorch-accelerated</code>å‘¢ï¼š<br>ï¼ˆ1ï¼‰ç†Ÿæ‚‰PyTorchçš„ç”¨æˆ·ï¼Œä½†å¸Œæœ›é¿å…ç¼–å†™å¸¸è§çš„è®­ç»ƒå¾ªç¯æ¨¡æ¿ï¼Œä»¥ä¸“æ³¨äºå…¶ä»–æ›´é‡è¦çš„éƒ¨åˆ†ã€‚<br>ï¼ˆ2ï¼‰å–œæ¬¢å¹¶ä¹äºé€‰æ‹©å’Œåˆ›å»ºè‡ªå·±çš„æ¨¡å‹ã€æŸå¤±å‡½æ•°ã€ä¼˜åŒ–å™¨å’Œæ•°æ®é›†çš„ç”¨æˆ·ã€‚<br>ï¼ˆ3ï¼‰å–œæ¬¢ç®€å•ä½†é«˜æ•ˆçš„åŠŸèƒ½çš„ç”¨æˆ·ï¼Œè¿™äº›åŠŸèƒ½çš„è¡Œä¸ºéœ€è¦å¾ˆå®¹æ˜“è°ƒè¯•ã€ç†è§£å’Œæ¨ç†ï¼ˆ<code>PyTorch Lightning</code>ï¼šä½ æŠ¥æˆ‘èº«ä»½è¯å¾—äº†ï¼‰ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œ<code>pytorch-accelerated</code>ä¸é€‚åˆä»€ä¹ˆç±»å‹çš„ç”¨æˆ·/å¼€å‘è€…å‘¢ï¼Ÿ<br>ï¼ˆ1ï¼‰å¦‚æœä½ æ­£åœ¨å¯»æ‰¾ä¸€ä¸ªç«¯åˆ°ç«¯çš„è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ä»åŠ è½½æ•°æ®åˆ°æ¨ç†çš„æ‰€æœ‰å†…å®¹ï¼Œè¯¥æ–¹æ¡ˆå¸®åŠ©ä½ é€‰æ‹©æ¨¡å‹ã€ä¼˜åŒ–å™¨æˆ–æŸå¤±å‡½æ•°ï¼Œæ­¤æ—¶å¯èƒ½æ›´é€‚åˆä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/fastai/fastai">fastai</a>ã€‚ <code>pytorch-accelerated</code>åªå…³æ³¨è®­ç»ƒè¿‡ç¨‹ï¼Œå…¶ä»–æ‰€æœ‰é—®é¢˜éƒ½ç”±ç”¨æˆ·è´Ÿè´£ã€‚<br>ï¼ˆ2ï¼‰å¦‚æœä½ æƒ³è‡ªå·±ç¼–å†™æ•´ä¸ªè®­ç»ƒå¾ªç¯ï¼Œä½†æ˜¯ä¸æƒ³æ¶‰åŠæ¼äººçš„è®¾å¤‡ç®¡ç†é—®é¢˜ï¼ˆæ¯”å¦‚å¤šæœºå¤šå¡å¹¶è¡Œï¼‰ï¼Œä½ å¯èƒ½æœ€é€‚åˆä½¿ç”¨<code>Hugging Face</code>çš„<a target="_blank" rel="noopener" href="https://github.com/huggingface/accelerate"><code>accelerate</code></a>ï¼ <code>accelerate</code>ä¸“æ³¨äºå°†<code>PyTorch</code>çš„åˆ†å¸ƒå¼è®­ç»ƒå’Œæ··åˆç²¾åº¦è®­ç»ƒå˜å¾—ç®€å•ï¼Œä¸è¿‡æ•´ä¸ªè®­ç»ƒå¾ªç¯å¾—è‡ªå·±å†™ã€‚<br>ï¼ˆ3ï¼‰å¦‚æœä½ æ­£åœ¨ç ”ç©¶ä¸€ä¸ªå®šåˆ¶çš„ã€é«˜åº¦å¤æ‚çš„ã€ä¸ç¬¦åˆé€šå¸¸è®­ç»ƒå¾ªç¯æ¨¡å¼çš„ç”¨ä¾‹ï¼Œå¹¶ä¸”æƒ³åœ¨ä½ é€‰æ‹©çš„ç¡¬ä»¶ä¸ŠæŒ¤å‡ºæ¯ä¸€ç‚¹æ€§èƒ½ï¼Œä½ å¯èƒ½æœ€å¥½åšæŒä½¿ç”¨åŸç”Ÿ<code>PyTorch</code>ï¼›åœ¨é«˜åº¦ä¸“ä¸šåŒ–çš„æƒ…å†µä¸‹ï¼Œä»»ä½•é«˜çº§<code>API</code>éƒ½ä¼šæˆä¸ºä¸€ç§å¼€é”€ã€‚</p>
<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>ï¼ˆæ³¨æ„æå‰å®‰è£…å¥½<code>pytorch</code>ï¼‰<br>ä½¿ç”¨<code>pip</code>å®‰è£…ï¼š<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pytorch-accelerated</span><br></pre></td></tr></table></figure><br>å…¶å®çœ‹<code>pytorch-accelerated</code>çš„<code>requirements.txt</code>ï¼Œå®ƒåªä¾èµ–äº<code>Hugging Face</code>çš„<code>accelerate</code>åº“åŠ<code>tqdm</code>ï¼ˆåœ¨ç»ˆç«¯ä¸‹æ˜¾ç¤ºè¿›åº¦æ¡ï¼‰ï¼Œå› æ­¤å¯ä»¥è¯´æ˜¯å®ƒçš„<code>API</code>å°±æ˜¯<code>PyTorch</code>çš„åŸç”Ÿ<code>API</code>åŠ ä¸Š<code>accelerate</code>çš„åˆ†å¸ƒå¼è®­ç»ƒçš„<code>API</code>ã€‚</p>
<h2 id="accelerateåº“"><a href="#accelerateåº“" class="headerlink" title="accelerateåº“"></a>accelerateåº“</h2><p><code>Hugging Face</code>çš„<code>ğŸ¤—accelerate</code>åº“ï¼ˆ<a target="_blank" rel="noopener" href="https://github.com/huggingface/accelerate">åœ°å€</a>ï¼‰ï¼Œå¯ä»¥æ— ç—›åœ°å¯¹<code>Pytorch</code>è¿›è¡Œå¤š<code>GPU</code>ã€<code>TPU</code>ã€<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/103685761">æ··åˆç²¾åº¦è®­ç»ƒ</a>ã€‚è§<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/ST0mWd4E7ZxMMl04_yTKzA">æœºå™¨ä¹‹å¿ƒçš„æŠ¥é“</a>ã€‚</p>
<blockquote>
<p>å¤šæ•° PyTorch é«˜çº§åº“éƒ½æ”¯æŒåˆ†å¸ƒå¼è®­ç»ƒå’Œæ··åˆç²¾åº¦è®­ç»ƒï¼Œä½†æ˜¯å®ƒä»¬å¼•å…¥çš„æŠ½è±¡åŒ–å¾€å¾€éœ€è¦ç”¨æˆ·å­¦ä¹ æ–°çš„ API æ¥å®šåˆ¶è®­ç»ƒå¾ªç¯ã€‚è®¸å¤š PyTorch ç”¨æˆ·å¸Œæœ›å®Œå…¨æ§åˆ¶è‡ªå·±çš„è®­ç»ƒå¾ªç¯ï¼Œä½†ä¸æƒ³ç¼–å†™å’Œç»´æŠ¤è®­ç»ƒæ‰€éœ€çš„å¤æ‚çš„æ ·æ¿ä»£ç ã€‚Hugging Face æœ€è¿‘å‘å¸ƒçš„æ–°åº“ Accelerate è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚<br><code>ğŸ¤—accelerate</code>æä¾›äº†ä¸€ä¸ªç®€å•çš„<code>API</code>ï¼Œå°†ä¸å¤š<code>GPU</code>ã€<code>TPU</code>ã€<code>fp16</code>ç›¸å…³çš„æ ·æ¿ä»£ç æŠ½ç¦»äº†å‡ºæ¥ï¼Œä¿æŒå…¶ä½™ä»£ç ä¸å˜ã€‚<code>PyTorch</code>ç”¨æˆ·æ— é¡»ä½¿ç”¨ä¸ä¾¿æ§åˆ¶å’Œè°ƒæ•´çš„æŠ½è±¡ç±»æˆ–ç¼–å†™ã€ç»´æŠ¤æ ·æ¿ä»£ç ï¼Œå°±å¯ä»¥ç›´æ¥ä¸Šæ‰‹å¤š<code>GPU</code>æˆ–<code>TPU</code>ã€‚</p>
</blockquote>
<p><code>ğŸ¤—accelerate</code>åº“æœ‰ä¸¤å¤§ç‰¹ç‚¹ï¼š<br>ï¼ˆ1ï¼‰æä¾›äº†ä¸€å¥—ç®€å•çš„<code>API</code>æ¥å¤„ç†åˆ†å¸ƒå¼è®­ç»ƒå’Œæ··åˆç²¾åº¦è®­ç»ƒï¼Œæ— éœ€åœ¨ä¸åŒæƒ…å½¢ä¸‹å¯¹ä»£ç è¿›è¡Œå¤§çš„æ”¹åŠ¨ï¼›<br>ï¼ˆ2ï¼‰æä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œæ¥å£å·¥å…·æ¥å¿«é€Ÿé…ç½®å¹¶å¹¶è¡Œè„šæœ¬ã€‚</p>
<h2 id="å¯é€‰"><a href="#å¯é€‰" class="headerlink" title="å¯é€‰"></a>å¯é€‰</h2><p>å¦‚æœæ˜¯æƒ³ä¸ºäº†ç›´æ¥è¿è¡Œ<code>pytorch-accelerated</code>æä¾›çš„<code>examples</code>ï¼Œåˆ™å¯ä»¥è¿™æ ·å®‰è£…<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/46775346/what-do-square-brackets-mean-in-pip-install">å…¶ä»–æ‰€ä¾èµ–çš„åŒ…</a>ï¼š<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pytorch-accelerated[examples]</span><br></pre></td></tr></table></figure></p>
<h1 id="é…ç½®å’Œè¿è¡Œ"><a href="#é…ç½®å’Œè¿è¡Œ" class="headerlink" title="é…ç½®å’Œè¿è¡Œ"></a>é…ç½®å’Œè¿è¡Œ</h1><p>å¯ä»¥ä½¿ç”¨<code>ğŸ¤—accelerate</code>çš„<code>CLI</code>å·¥å…·æ¥ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼š<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">accelerate config --config_file accelerate_config.yaml</span><br></pre></td></tr></table></figure><br>ç„¶åè¿è¡Œï¼š<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">accelerate launch --config_file accelerate_config.yaml train.py [--training-args]</span><br></pre></td></tr></table></figure><br>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¹Ÿä¸æ˜¯å¿…é¡»è¦ç”¨<code>CLI</code>å·¥å…·ã€‚å¦‚æœæƒ³æ›´ç²¾ç»†åœ°æ§åˆ¶å¯åŠ¨å‘½ä»¤å’Œå‚æ•°ï¼Œä»ç„¶å¯ä»¥é€šè¿‡é€šå¸¸çš„æ–¹å¼æ¥è¿è¡Œè„šæœ¬ï¼š<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python train.py / python -m torch.distributed ...</span><br></pre></td></tr></table></figure></p>
<h1 id="MNISTä¾‹å­"><a href="#MNISTä¾‹å­" class="headerlink" title="MNISTä¾‹å­"></a>MNISTä¾‹å­</h1><p><code>MNIST</code>æ‰‹å†™å­—ç¬¦åˆ†ç±»å¯ä»¥è¯´æ˜¯æ·±åº¦å­¦ä¹ é¢†åŸŸçš„<code>Hello World</code>ã€‚<br>è¿™ä¸€èŠ‚å°†ä»¥<code>MNIST</code>æ¥çœ‹çœ‹<code>pytorch-accelerated</code>æ˜¯æ€ä¹ˆä½¿ç”¨çš„ã€‚</p>
<h2 id="æ•°æ®å’Œæ¨¡å‹å‡†å¤‡"><a href="#æ•°æ®å’Œæ¨¡å‹å‡†å¤‡" class="headerlink" title="æ•°æ®å’Œæ¨¡å‹å‡†å¤‡"></a>æ•°æ®å’Œæ¨¡å‹å‡†å¤‡</h2><p>å› ä¸º<code>pytorch-accelerated</code>ä¸“æ³¨äºè®­ç»ƒæ¨¡å‹éƒ¨åˆ†ï¼Œå› æ­¤æ•°æ®çš„åŠ è½½å’Œæ¨¡å‹çš„æ„å»ºã€é…ç½®éƒ½æ˜¯ä½¿ç”¨çš„åŸç”Ÿçš„<code>PyTorch</code>çš„ä»£ç ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># examples/train_mnist.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn, optim</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> random_split</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"><span class="keyword">from</span> torchvision.datasets <span class="keyword">import</span> MNIST</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½æ•°æ®é›†</span></span><br><span class="line">dataset = MNIST(os.getcwd(), download=<span class="literal">True</span>, transform=transforms.ToTensor())</span><br><span class="line"><span class="comment"># æ‹†åˆ†æ•°æ®é›†</span></span><br><span class="line">train_dataset, validation_dataset, test_dataset = random_split(dataset, [<span class="number">50000</span>, <span class="number">5000</span>, <span class="number">5000</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ç¥ç»ç½‘ç»œæ¨¡å‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MNISTModel</span>(<span class="params">nn.Module</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.main = nn.Sequential(</span><br><span class="line">            nn.Linear(in_features=<span class="number">784</span>, out_features=<span class="number">128</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.Linear(in_features=<span class="number">128</span>, out_features=<span class="number">64</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.Linear(in_features=<span class="number">64</span>, out_features=<span class="number">10</span>),</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span>(<span class="params">self, <span class="built_in">input</span></span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.main(<span class="built_in">input</span>.view(<span class="built_in">input</span>.shape[<span class="number">0</span>], -<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–æ¨¡å‹</span></span><br><span class="line">model = MNISTModel()</span><br><span class="line"><span class="comment"># å®šä¹‰ä¼˜åŒ–å™¨</span></span><br><span class="line">optimizer = optim.SGD(model.parameters(), lr=<span class="number">0.001</span>, momentum=<span class="number">0.9</span>)</span><br><span class="line"><span class="comment"># å®šä¹‰æŸå¤±å‡½æ•°</span></span><br><span class="line">loss_func = nn.CrossEntropyLoss()</span><br><span class="line">	</span><br></pre></td></tr></table></figure></p>
<h2 id="è®­ç»ƒå¾ªç¯"><a href="#è®­ç»ƒå¾ªç¯" class="headerlink" title="è®­ç»ƒå¾ªç¯"></a>è®­ç»ƒå¾ªç¯</h2><p>åŠ è½½äº†æ¨¡å‹å’Œæ•°æ®åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯ç¼–å†™è®­ç»ƒå¾ªç¯ã€‚<br>è¿™é‡Œå°±æ˜¯<code>pytorch-accelerated</code>çš„ç”¨æ­¦ä¹‹åœ°ï¼Œå”¯ä¸€è¦åšçš„å°±æ˜¯å¯¼å…¥<code>Trainer</code>ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pytorch_accelerated <span class="keyword">import</span> Trainer</span><br><span class="line"></span><br><span class="line"><span class="comment"># Trainerè¢«è®¾è®¡æˆç”¨æ¥å°è£…ä¸€ä¸ªå®Œæ•´çš„è®­ç»ƒå¾ªç¯</span></span><br><span class="line"><span class="comment"># å°†æ¨¡å‹ã€æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨éƒ½ä¼ å…¥Trainerä¸­</span></span><br><span class="line">trainer = Trainer(</span><br><span class="line">		model,</span><br><span class="line">		loss_func=loss_func,</span><br><span class="line">		optimizer=optimizer,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¥å£ç‚¹æ˜¯trainæ–¹æ³•ï¼Œå®šä¹‰äº†è¯¥æ€æ ·è®­ç»ƒ</span></span><br><span class="line"><span class="comment"># å¯ä»¥è®¾ç½®è®­ç»ƒé›†ã€éªŒè¯é›†ï¼ˆæ³¨æ„æ˜¯éªŒè¯é›†ï¼Œä¸æ˜¯æµ‹è¯•é›†ï¼‰ã€è¿­ä»£æ¬¡æ•°ã€æ‰¹å¤„ç†å¤§å°</span></span><br><span class="line"><span class="comment"># è¿˜å¯ä»¥è®¾ç½®å­¦ä¹ ç‡ç­–ç•¥ã€æ¢¯åº¦ç´¯åŠ ç­‰ï¼Œè¿™é‡Œæ²¡æœ‰ç”¨åˆ°</span></span><br><span class="line">trainer.train(</span><br><span class="line">	train_dataset=train_dataset,</span><br><span class="line">	eval_dataset=validation_dataset,</span><br><span class="line">	num_epochs=<span class="number">8</span>,</span><br><span class="line">	per_device_batch_size=<span class="number">32</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯„ä¼°æ¨¡å‹</span></span><br><span class="line">trainer.evaluate(</span><br><span class="line">	dataset=test_dataset,</span><br><span class="line">	per_device_batch_size=<span class="number">64</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h2 id="è®­ç»ƒ"><a href="#è®­ç»ƒ" class="headerlink" title="è®­ç»ƒ"></a>è®­ç»ƒ</h2><h3 id="ç”Ÿæˆé…ç½®æ–‡ä»¶"><a href="#ç”Ÿæˆé…ç½®æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆé…ç½®æ–‡ä»¶"></a>ç”Ÿæˆé…ç½®æ–‡ä»¶</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">accelerate config --config_file train_mnist.yaml</span><br></pre></td></tr></table></figure>
<h3 id="å¼€å§‹è®­ç»ƒ"><a href="#å¼€å§‹è®­ç»ƒ" class="headerlink" title="å¼€å§‹è®­ç»ƒ"></a>å¼€å§‹è®­ç»ƒ</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">accelerate launch --config_file train_mnist.yaml train_mnist.py</span><br></pre></td></tr></table></figure>
<h2 id="å¢åŠ æŒ‡æ ‡"><a href="#å¢åŠ æŒ‡æ ‡" class="headerlink" title="å¢åŠ æŒ‡æ ‡"></a>å¢åŠ æŒ‡æ ‡</h2><p>ä¸Šè¿°ä¾‹å­ä¸­è¿½è¸ªçš„æŒ‡æ ‡ä»…ä»…æ˜¯æ¯æ¬¡è¿­ä»£çš„æŸå¤±<code>loss</code>ï¼Œä¸ºäº†å¯¹è®­ç»ƒç»“æœæœ‰æ›´æ·±å…¥çš„æ´å¯Ÿï¼Œå¯ä»¥å¢åŠ æ›´å¤šçš„æŒ‡æ ‡ã€‚<br>å¯¹äºæŒ‡æ ‡çš„è®¡ç®—ï¼Œè¿™é‡Œå¼•å…¥äº†<a target="_blank" rel="noopener" href="https://github.com/Lightning-AI/metrics"><code>torchmetrics</code></a>ï¼ˆå‘ç°è¿™ä¸ªåº“è¿˜æ˜¯<code>PyTorch-Lightning</code>ç¤¾åŒºå¼€å‘çš„ï¼Œè¿™æ³¢<code>PyTorch-Lightning</code>è¢«äººæ‘˜æ¡ƒäº†ï¼Œè¡€äºğŸ¤—ï¼‰ï¼Œè¯¥åº“å…¼å®¹åˆ†å¸ƒå¼è®­ç»ƒï¼Œå› æ­¤å°±ä¸éœ€è¦æ‰‹åŠ¨ä»ä¸åŒè¿›ç¨‹ä¸­èšåˆè®¡ç®—ç»“æœã€‚<br>è®¡ç®—æŒ‡æ ‡æœ‰ä¸¤ç§æ–¹å¼ï¼š<br>ï¼ˆ1ï¼‰å®šä¹‰ä¸€ä¸ªç»§æ‰¿è‡ª<code>Trainer</code>çš„å­ç±»ï¼Œ<br>ï¼ˆ2ï¼‰ä½¿ç”¨å›è°ƒ<code>callback</code>ã€‚<br>å…·ä½“ä½¿ç”¨å“ªç§æ–¹å¼æå¤§åœ°å–å†³äºç”¨æˆ·çš„å–œå¥½ã€‚<br>ä¸è¿‡ä½œè€…æœ‰å¦‚ä¸‹å»ºè®®ï¼šå› ä¸ºè®¡ç®—æŒ‡æ ‡å®é™…ä¸Šæ˜¯ä¸èƒ½å½±å“è®­ç»ƒä»£ç çš„ï¼Œå› æ­¤ä½¿ç”¨<code>callback</code>å¯èƒ½æ˜¯ä¸€ä¸ªå¥½çš„æ–¹å¼ï¼Œå› ä¸ºä½¿ç”¨<code>Trainer</code>å­ç±»çš„è¯ï¼Œå®ƒä¹Ÿä¼šé—´æ¥åœ°å‚ä¸è®­ç»ƒè¿‡ç¨‹ã€‚ä¸è¿‡è¿˜æ˜¯å…·ä½“æƒ…å†µå…·ä½“åˆ†æã€‚æ³¨æ„ï¼Œå› ä¸º<code>callbacks</code>éƒ½æ˜¯é¡ºåºæ‰§è¡Œçš„ï¼Œå¿…é¡»ä¿è¯åœ¨æ‰“å°æŒ‡æ ‡ä¹‹å‰å°±è°ƒç”¨è¿™äº›å›è°ƒã€‚<br>ä¸‹é¢æ˜¯å¯¹æ¯”è¿™ä¸¤ç§å®ç°æ–¹å¼ã€‚</p>
<h3 id="ä½¿ç”¨Trainerå­ç±»"><a href="#ä½¿ç”¨Trainerå­ç±»" class="headerlink" title="ä½¿ç”¨Trainerå­ç±»"></a>ä½¿ç”¨Trainerå­ç±»</h3><p><code>Trainer</code>æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥è¢«é‡è½½ï¼Œå…·ä½“çš„æ–‡æ¡£åœ¨<a target="_blank" rel="noopener" href="https://pytorch-accelerated.readthedocs.io/en/latest/trainer.html#customizing-trainer-behaviour">è¿™é‡Œ</a>ã€‚ä¸»è¦çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯æœ‰åŠ¨è¯å‰ç¼€ï¼ˆæ¯”å¦‚<code>create</code>å’Œ<code>calculate</code>ï¼‰çš„æ–¹æ³•éƒ½æ˜¯æœŸæœ›èƒ½è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œå…¶ä»–çš„æ–¹æ³•ï¼ˆæ¯”å¦‚<code>optimizer.step()</code>ï¼‰åˆ™æ˜¯ç”¨æ¥è®¾ç½®å†…éƒ¨çŠ¶æ€ã€‚<br>ç¤ºä¾‹ä»£ç ä¸ºï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Copyright Â© 2021 Chris Hughes</span></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line"><span class="comment"># This example trains a model on the MNIST Dataset</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This example demonstrates how the default trainer class can be overridden</span></span><br><span class="line"><span class="comment"># so that we can record classification metrics</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Note, this example requires installing the torchmetrics package</span></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn, optim</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> random_split</span><br><span class="line"><span class="keyword">from</span> torchmetrics <span class="keyword">import</span> MetricCollection, Accuracy, Precision, Recall</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"><span class="keyword">from</span> torchvision.datasets <span class="keyword">import</span> MNIST</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pytorch_accelerated <span class="keyword">import</span> Trainer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MNISTModel</span>(<span class="params">nn.Module</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.main = nn.Sequential(</span><br><span class="line">            nn.Linear(in_features=<span class="number">784</span>, out_features=<span class="number">128</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.Linear(in_features=<span class="number">128</span>, out_features=<span class="number">64</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.Linear(in_features=<span class="number">64</span>, out_features=<span class="number">10</span>),</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.main(x.view(x.shape[<span class="number">0</span>], -<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrainerWithMetrics</span>(<span class="params">Trainer</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, num_classes, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># this will be moved to the correct device automatically by the</span></span><br><span class="line">        <span class="comment"># MoveModulesToDeviceCallback callback, which is used by default</span></span><br><span class="line">        self.metrics = MetricCollection(</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;accuracy&quot;</span>: Accuracy(num_classes=num_classes),</span><br><span class="line">                <span class="string">&quot;precision&quot;</span>: Precision(num_classes=num_classes),</span><br><span class="line">                <span class="string">&quot;recall&quot;</span>: Recall(num_classes=num_classes),</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">calculate_eval_batch_loss</span>(<span class="params">self, batch</span>):</span></span><br><span class="line">        batch_output = <span class="built_in">super</span>().calculate_eval_batch_loss(batch)</span><br><span class="line">        preds = batch_output[<span class="string">&quot;model_outputs&quot;</span>].argmax(dim=-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.metrics.update(preds, batch[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> batch_output</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eval_epoch_end</span>(<span class="params">self</span>):</span></span><br><span class="line">        metrics = self.metrics.compute()</span><br><span class="line">        self.run_history.update_metric(<span class="string">&quot;accuracy&quot;</span>, metrics[<span class="string">&quot;accuracy&quot;</span>].cpu())</span><br><span class="line">        self.run_history.update_metric(<span class="string">&quot;precision&quot;</span>, metrics[<span class="string">&quot;precision&quot;</span>].cpu())</span><br><span class="line">        self.run_history.update_metric(<span class="string">&quot;recall&quot;</span>, metrics[<span class="string">&quot;recall&quot;</span>].cpu())</span><br><span class="line"></span><br><span class="line">        self.metrics.reset()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    dataset = MNIST(os.getcwd(), download=<span class="literal">True</span>, transform=transforms.ToTensor())</span><br><span class="line">    num_classes = <span class="built_in">len</span>(dataset.class_to_idx)</span><br><span class="line"></span><br><span class="line">    train_dataset, validation_dataset, test_dataset = random_split(</span><br><span class="line">        dataset, [<span class="number">50000</span>, <span class="number">5000</span>, <span class="number">5000</span>]</span><br><span class="line">    )</span><br><span class="line">    model = MNISTModel()</span><br><span class="line">    optimizer = optim.SGD(model.parameters(), lr=<span class="number">0.001</span>, momentum=<span class="number">0.9</span>)</span><br><span class="line">    loss_func = nn.CrossEntropyLoss()</span><br><span class="line"></span><br><span class="line">    trainer = TrainerWithMetrics(</span><br><span class="line">        model=model, loss_func=loss_func, optimizer=optimizer, num_classes=num_classes</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    trainer.train(</span><br><span class="line">        train_dataset=train_dataset,</span><br><span class="line">        eval_dataset=validation_dataset,</span><br><span class="line">        num_epochs=<span class="number">2</span>,</span><br><span class="line">        per_device_batch_size=<span class="number">32</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    trainer.evaluate(</span><br><span class="line">        dataset=test_dataset,</span><br><span class="line">        per_device_batch_size=<span class="number">64</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p>
<h3 id="ä½¿ç”¨å›è°ƒ"><a href="#ä½¿ç”¨å›è°ƒ" class="headerlink" title="ä½¿ç”¨å›è°ƒ"></a>ä½¿ç”¨å›è°ƒ</h3><p>ä¸Šé¢çš„ä»£ç å¯èƒ½å·²ç»æœ‰æ‰€æ˜¾ç¤ºï¼Œå¯¹äºâ€œå¢åŠ æŒ‡æ ‡â€è¿™ç§å°çš„å¾®è°ƒï¼Œå¦‚æœä½¿ç”¨<code>Trainer</code>å­ç±»çš„è¯ä¼šæ˜¾å¾—æœ‰äº›ç”¨åŠ›è¿‡çŒ›ã€‚<br>æ­¤ä¾‹ä¸­ï¼Œå¯ä»¥ä¿æŒé»˜è®¤çš„<code>trainer</code>ä¸å˜ï¼Œè€Œä½¿ç”¨å›è°ƒæ¥æ‰©å±•åŠŸèƒ½ã€‚<br>ä¸ºäº†åˆ›å»ºä¸€ä¸ªæ–°çš„å›è°ƒï¼Œéœ€è¦åˆ›å»º<code>TrainerCallback</code>çš„å­ç±»ï¼Œç„¶åé‡è½½ç›¸å…³æ–¹æ³•ï¼Œæ–‡æ¡£è§<a target="_blank" rel="noopener" href="https://pytorch-accelerated.readthedocs.io/en/latest/callbacks.html#creating-new-callbacks">è¿™é‡Œ</a>ã€‚ä¸ºäº†é¿å…ä¸<code>Trainer</code>çš„æ–¹æ³•æ··æ·†ï¼Œæ‰€æœ‰çš„å›è°ƒæ–¹æ³•éƒ½æœ‰<code>on_</code>å‰ç¼€ã€‚<br>åˆ›å»ºæ–°çš„å›è°ƒï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torchmetrics <span class="keyword">import</span> MetricCollection, Accuracy, Precision, Recall</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pytorch_accelerated.callbacks <span class="keyword">import</span> TrainerCallback</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassificationMetricsCallback</span>(<span class="params">TrainerCallback</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, num_classes</span>):</span></span><br><span class="line">        self.metrics = MetricCollection(</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;accuracy&quot;</span>: Accuracy(num_classes=num_classes),</span><br><span class="line">                <span class="string">&quot;precision&quot;</span>: Precision(num_classes=num_classes),</span><br><span class="line">                <span class="string">&quot;recall&quot;</span>: Recall(num_classes=num_classes),</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_move_to_device</span>(<span class="params">self, trainer</span>):</span></span><br><span class="line">        self.metrics.to(trainer.device)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_training_run_start</span>(<span class="params">self, trainer, **kwargs</span>):</span></span><br><span class="line">        self._move_to_device(trainer)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_evaluation_run_start</span>(<span class="params">self, trainer, **kwargs</span>):</span></span><br><span class="line">        self._move_to_device(trainer)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_eval_step_end</span>(<span class="params">self, trainer, batch, batch_output, **kwargs</span>):</span></span><br><span class="line">        preds = batch_output[<span class="string">&quot;model_outputs&quot;</span>].argmax(dim=-<span class="number">1</span>)</span><br><span class="line">        self.metrics.update(preds, batch[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_eval_epoch_end</span>(<span class="params">self, trainer, **kwargs</span>):</span></span><br><span class="line">        metrics = self.metrics.compute()</span><br><span class="line">        trainer.run_history.update_metric(<span class="string">&quot;accuracy&quot;</span>, metrics[<span class="string">&quot;accuracy&quot;</span>].cpu())</span><br><span class="line">        trainer.run_history.update_metric(<span class="string">&quot;precision&quot;</span>, metrics[<span class="string">&quot;precision&quot;</span>].cpu())</span><br><span class="line">        trainer.run_history.update_metric(<span class="string">&quot;recall&quot;</span>, metrics[<span class="string">&quot;recall&quot;</span>].cpu())</span><br><span class="line"></span><br><span class="line">        self.metrics.reset()</span><br></pre></td></tr></table></figure><br>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œåœ¨è®­ç»ƒæˆ–éªŒè¯ä¹‹å‰ï¼Œéœ€è¦æ‰‹åŠ¨åœ°å°†æŒ‡æ ‡ç§»åŠ¨åˆ°æ­£ç¡®åœ°è®¾å¤‡ä¸Šã€‚ä¸è¿‡<code>Trainer</code>å·²ç»å°†è¿™ä¸€æ­¥åšäº†éå¸¸ç®€å•çš„å¤„ç†ï¼Œå¯ä»¥ä¾æ®ä¸Šä¸‹æ–‡è¿”å›æ­£ç¡®çš„è®¾å¤‡ï¼Œå³ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pytorch_accelerated.trainer <span class="keyword">import</span> DEFAULT_CALLBACKS</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†è‡ªå®šä¹‰çš„å›è°ƒä¼ å…¥Trainer</span></span><br><span class="line"><span class="comment"># å› ä¸ºæƒ³ä¿æŒé»˜è®¤è¡Œä¸ºï¼Œæ‰€ä»¥å°†è‡ªå®šä¹‰çš„å›è°ƒæ”¾åœ¨æ‰€æœ‰çš„é»˜è®¤å›è°ƒä¹‹å‰ã€‚</span></span><br><span class="line">trainer = Trainer(</span><br><span class="line">	model,</span><br><span class="line">	loss_func=loss_func,</span><br><span class="line">	optimizer=optimizer,</span><br><span class="line">	callbacks=(</span><br><span class="line">		ClassificationMetricsCallback(</span><br><span class="line">			num_classes=num_classes,</span><br><span class="line">		),</span><br><span class="line">		*DEFAULT_CALLBACKS,</span><br><span class="line">	),</span><br><span class="line">)</span><br></pre></td></tr></table></figure><br>ç„¶åå°†ä¸Šé¢ä»£ç å¤åˆ¶è¿›å…¥æœ€å¼€å§‹çš„ä»£ç ä¸­å³å¯ï¼Œæ— éœ€å˜åŠ¨å…¶ä»–åœ°æ–¹çš„ä»£ç ï¼ˆåªæ˜¯éœ€è¦åœ¨åˆ›å»ºæ•°æ®é›†åï¼Œè®¡ç®—ä¸€ä¸‹å…¶åˆ†ç±»æ•°ç›®ä»¥ä¼ å…¥å›è°ƒ<code>num_classes = len(dataset.class_to_idx)</code>ï¼‰ã€‚</p>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>å®é™…åªä»è¿™ä¸ª<code>MNIST</code>ä¾‹å­è¿˜ä¸èƒ½çœ‹å‡º<code>pytorch-accelerated</code>èƒ½åœ¨å¤šå¤§ç¨‹åº¦ä¸Šæé«˜æ•ˆç‡ï¼Œåé¢éœ€è¦å¤šç ”ç©¶ä¸€ä¸‹å®ƒçš„ä¾‹å­ï¼Œæ¯•ç«Ÿ<code>é€šç”¨æ¨¡æ¿</code>çš„æ„ä¹‰åœ¨äºèƒ½é€‚ç”¨äºå¤šç§æƒ…å½¢ã€‚ç•™å‘å¾…å¡«ã€‚</p>

    </div>

    
    
    
        <div class="reward-container">
  <div></div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechat_reward.png" alt="Xin-Bo Qi(äº“æ¬£æ³¢) WeChat Pay">
        <p>WeChat Pay</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/PyTorch/" rel="tag"># PyTorch</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/05/22/ImJoy_13/" rel="prev" title="å¼€æºæ·±åº¦å­¦ä¹ è®¡ç®—å¹³å°ImJoyè§£æï¼š13 -- Kaibuåº”ç”¨">
      <i class="fa fa-chevron-left"></i> å¼€æºæ·±åº¦å­¦ä¹ è®¡ç®—å¹³å°ImJoyè§£æï¼š13 -- Kaibuåº”ç”¨
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/05/29/pytorch-accelerated_1/" rel="next" title="è½»é‡çº§PyTorché€šç”¨è®­ç»ƒæ¨¡æ¿pytorch-acceleratedè§£æï¼š1 -- APIä¹‹Trainer">
      è½»é‡çº§PyTorché€šç”¨è®­ç»ƒæ¨¡æ¿pytorch-acceleratedè§£æï¼š1 -- APIä¹‹Trainer <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.</span> <span class="nav-text">ä»‹ç»</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%AE%E6%A0%87%E7%94%A8%E6%88%B7"><span class="nav-number">1.1.</span> <span class="nav-text">ç›®æ ‡ç”¨æˆ·</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">2.</span> <span class="nav-text">å®‰è£…</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#accelerate%E5%BA%93"><span class="nav-number">2.1.</span> <span class="nav-text">accelerateåº“</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%AF%E9%80%89"><span class="nav-number">2.2.</span> <span class="nav-text">å¯é€‰</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%92%8C%E8%BF%90%E8%A1%8C"><span class="nav-number">3.</span> <span class="nav-text">é…ç½®å’Œè¿è¡Œ</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MNIST%E4%BE%8B%E5%AD%90"><span class="nav-number">4.</span> <span class="nav-text">MNISTä¾‹å­</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%92%8C%E6%A8%A1%E5%9E%8B%E5%87%86%E5%A4%87"><span class="nav-number">4.1.</span> <span class="nav-text">æ•°æ®å’Œæ¨¡å‹å‡†å¤‡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%AD%E7%BB%83%E5%BE%AA%E7%8E%AF"><span class="nav-number">4.2.</span> <span class="nav-text">è®­ç»ƒå¾ªç¯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%AD%E7%BB%83"><span class="nav-number">4.3.</span> <span class="nav-text">è®­ç»ƒ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">4.3.1.</span> <span class="nav-text">ç”Ÿæˆé…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E5%A7%8B%E8%AE%AD%E7%BB%83"><span class="nav-number">4.3.2.</span> <span class="nav-text">å¼€å§‹è®­ç»ƒ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A2%9E%E5%8A%A0%E6%8C%87%E6%A0%87"><span class="nav-number">4.4.</span> <span class="nav-text">å¢åŠ æŒ‡æ ‡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8Trainer%E5%AD%90%E7%B1%BB"><span class="nav-number">4.4.1.</span> <span class="nav-text">ä½¿ç”¨Trainerå­ç±»</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9B%9E%E8%B0%83"><span class="nav-number">4.4.2.</span> <span class="nav-text">ä½¿ç”¨å›è°ƒ</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%90%8E%E8%AE%B0"><span class="nav-number">5.</span> <span class="nav-text">åè®°</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Xin-Bo Qi(äº“æ¬£æ³¢)"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Xin-Bo Qi(äº“æ¬£æ³¢)</p>
  <div class="site-description" itemprop="description">Digitize everything to realize Digitalization!</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">167</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">56</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/qixinbo" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;qixinbo" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:qixinbo@gmail.com" title="E-Mail â†’ mailto:qixinbo@gmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/qixinbo" title="Twitter â†’ https:&#x2F;&#x2F;twitter.com&#x2F;qixinbo" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS â†’ &#x2F;atom.xml"><i class="fas fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.tsinghua.edu.cn/" title="https:&#x2F;&#x2F;www.tsinghua.edu.cn" rel="noopener" target="_blank">THU</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.imr.cas.cn/" title="http:&#x2F;&#x2F;www.imr.cas.cn" rel="noopener" target="_blank">IMR</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.sdu.edu.cn/" title="http:&#x2F;&#x2F;www.sdu.edu.cn" rel="noopener" target="_blank">SDU</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://liam0205.me/" title="http:&#x2F;&#x2F;liam0205.me&#x2F;" rel="noopener" target="_blank">é»„æ™¨æˆ</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xin-Bo Qi(äº“æ¬£æ³¢)</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://qixinbo.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "http://qixinbo.github.io/2022/05/28/pytorch-accelerated_0/";
    this.page.identifier = "2022/05/28/pytorch-accelerated_0/";
    this.page.title = "è½»é‡çº§PyTorché€šç”¨è®­ç»ƒæ¨¡æ¿pytorch-acceleratedè§£æï¼š0 -- ä»‹ç»åŠå…¥é—¨";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://qixinbo.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
